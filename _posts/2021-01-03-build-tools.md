---
title: "Build Tools"
categories: 
  - java
last_modified_at: 2021-01-07T23:00:00+09:00
---

### 빌드(Build)란?
    일반적으로 빌드란 소스코드 파일을 컴퓨터에서 실행할 수 있는 독립적인 형태로 변환하는 과정과 그 결과를 말한다.
    
    예를들어 간단히 자바 프로젝트를 만들어 진행할 때, 그 안에는 우리가 작성한 .java 파일들과
    정적 파일등에 해당하는 resource 파일들이 존재하게 된다. 
    빌드를 진행하는 것은 소스코드를 compile하여 클래스 파일(.class)로 변환하고 resource 파일들을 클래스 파일에서
    참조할 수 있는 적절한 위치로 옮기고, 추가적으로 META-INF와 MANIFEST.MF들을 하나로 압축하는 과정을 의미한다.
    
    그렇다고해서 컴파일이 필요한 언어에만 국한되는 작업은 아니다.
    말했듯이 resource 파일등 어플리케이션의 실행에 필요한 파일들의 이동이나 압축하는 것도 빌드 프로세스에 포함되기 때문에
    인터프리터 언어로 작성된 프로그램에도 포함되는 작업이다.
    
    즉, 빌드란 종속성 다운로드, 컴파일, 코드 패키징, 테스트, 배포등의 모든 과정들을 의미한다.

### 빌드 툴(Build Tool)이란?
    소스 코드의 컴파일, 테스트, 정적분석, 링크, 패키징등(위에서 말한 빌드)을 통해 실행 가능한 애플리케이션을 자동 생성하는 프로그램이다.
    
    즉, 빌드 툴은 위에서 설명한 빌드 과정을 테스크에 정의된대로 실행하게 된다.(Gradle에서는 이러한 행위의 단위를 Task라고 칭한다.)

### 빌드 툴은 왜 써야할까?
    소규모 프로젝트에서는 개발자가 스스로 빌드 과정을 진행할 수 있다.
    하지만 대규모 프로젝트에서는 순서에 맞게 빌드하고 종속성을 추적, 라이브러리를 다운로드하는 과정이 비효율적이고 실용적이지 않다.
    빌드 툴을 사용하면 빌드 프로세스(과정)을 일관성있게 수행할 수 있다.
    

### 빌드 툴의 대표적인 2가지 종류        
### 메이븐
    자바 프로젝트의 빌드(build)를 자동화 해주는 빌드 툴이다.
    기존에는 Ant가 많이 사용되었지만 Maven이 Ant를 넘어서 더 많은 개발자들이 사용하게 되었다.

### 메이븐의 특징
    1. 필요한 라이브러리를 특정 문서(pom.xml)에 정의해 놓으면 내가 사용할 라이브러리 뿐만 아니라
       해당 라이브러리가 작동하는데에 필요한 다른 라이브러리들까지 관리하여 네트워크를 통해서 자동으로 다운받아 준다.
    2. 라이브러리를 공유하는 파일 서버라고 볼 수 있는 중앙 저장소(아파치재단에서 운영 관리)를 통해 자동으로 의존성을 관리한다.
    3. 하지만 라이브러리가 서로 종속적일 경우 복잡한 XML 구조를 갖게 된다.
    4. XML 구조로 인해 계층적인 데이터를 표현하기에는 좋지만, 플로우나 조건부 상황을 표한하기에는 어렵다.
    
### Maven이 참조하는 설정 파일
    프로그래밍에 직접적인 연관이 있는 두개의 설정파일을 알아보자.

1. settings.xml
    - settings.xml은 maven tool 자체에 관련된 설정을 담당한다.
    - MAVEN_HOME/conf/ 아래에 있다. ( * MAVEN_HOME은 환경변수에 설정한 경로)

2. pom.xml
    - 하나의 자바 프로젝트에 빌드 툴로 maven을 설정했다면, 프로젝트 최상위 디렉토리에 "pom.xml"이라는 파일이 생성되었을 것이다.
    - pom.xml은 POM(Project Object Model)을 설정하는 부분으로 프로젝트 내 빌드 옵션을 설정하는 부분이다.

    
    
    
## Maven의 Lifecycle
- maven 에서는 미리 정의하고 있는 빌드 순서가 있으며 이 순서를 라이프사이클이라고 한다. 


            Clean : 이전 빌드에서 생성된 파일들을 삭제하는 단계
            Validate : 프로젝트가 올바른지 확인학고 필요한 모든 정보를 사용할 수 있는 지 확인하는 단계
            Compile : 프로젝트의 소스코드를 컴파일하는 단계
            Test : 유닛(단위) 테스트를 수행하는 단계(테스트 실패시 빌드 실패로 처리, 스킵 가능)
            Package : 실제 컴파일된 소스 코드와 리소스들을 jar등의 배포를 위한 패키지로 만드는 단계
            Verify : 통합테스트 결과에 대한 검사를 실행하여 품질 기준을 충족하는지 확인하는 단계
            Install : 패키지를 로컬 저장소에 설치하는 단계
            Site : 프로젝트 문서를 생성하는 단계
            Deploy : 만들어진 Package를 원격 저장소에 release하는 단계

- 위에 9개의 라이프사이클 말고도 더 많은종류의 라이프사이클이 존재한다. 이를 크게 Clean, Build, site 세가지 라이프사이클로<br> 나누고 있다.
각 단계를 모두 수행하는 것이 아니라 원하는 단계까지만 수행할 수도 있으며 test단계는 큰 프로젝트의 경우에 몇시간이 소요될 수도있으니 수행하지 않도록 스킵이 가능하다.

## Phase와 Goal
- Phase는 Maven의 Build LifeCycle의 각각의 단계를 의미한다. 각각의 Phase는 의존관계를 가지고있어 해당 Phase가 수행되려면<br>
이전 단계의 Phase가 모두 수행되어야 한다.

- 메이븐에서 제공되는 모든 기능은 플러그인 기반으로 동작하는데 메이븐은 라이플사이클에 포함되어있는 Phase마저도 플러그인을<br>
통해 실질적인 작업이 수행된다. 즉 각각의 Phase는 어떤 일을 할지 정의하지 않고 어떤 플러그인의 Goal을 실행할지 설정한다.


## POM - Project Object Model
- pom은 Project Object Model 의 약자로 이름 그대로 Project Object Model의 정보를 담고있는 파일이다.<br>
이 파일에서 주요하게 다루는 기능들은 다음과 같다.

            
            -프로젝트 정보 : 프로젝트의 이름, 개발자 목록, 라이센스 등
            -빌드 설정 : 소스, 리소스, 라이프 사이클별 실행한 플러그인(goal)등 빌드와 관련된 설정
            -빌드 환경 : 사용자 환경 별로 달라질 수 있는 프로파일 정보
            -POM연관 정보 : 의존 프로젝트(모듈), 상위 프로젝트, 포함하고 있는 하위 모듈 등
            POM은 pom.xml파일을 말하며 Maven의 기능을 이용하기 위해 POM이 사용된다.

























            
## Gradle

- Gradle이란 기본적으로 빌드 배포 도구(Build Tool)이다. 안드로이드 앱을 만들때 필요한 공식 빌드시스템이기도 하며 JAVA, C/C++, Python 등을 지원한다.<br>
Ant와 Maven의 장점을 모아모아 2012년 출시되었고 Android OS의 빌드 도구로 채택 되었다. <br>
빌드툴인 Ant Builder와 그루비 스크립트를 기반으로 구축되어 기존 Ant의 역할과 배포 스크립트의 기능을 모두 사용가능하다.


- 기본 메이븐의 경우 XML로 라이브러리를 정의하고 활용하도록 되어 있으나, Gradle의 경우 별도의 빌드스크립트를 통하여 사용할 어플리케이션 버전, 라이브러리등의 항목을 설정 할 수 있다.

- 장점으로는 스크립트 언어로 구성되어 있기때문에, XML과 달리 변수선언, if, else, for등의 로직이 구현가능하여 간결하게 구성 가능하다.

            
            라이브러리 관리 : 메이븐 레파지토리를 동일하게 사용할 수 있어서 설정된 서버를 통하여 라이브러리를 다운로드 받아 모두 동일한 의존성을 가진 환경을 수정할 수 있다. 자신이 추가한 라이브러리도 레파지토리 서버에 올릴 수 있다.
            
            프로젝트 관리 : 모든 프로젝트가 일관된 디렉토리 구조를 가지고 빌드 프로세스를 유지하도록 도와준다.
            
            단위 테스트 시 의존성 관리 : junit 등을 사용하기 위해서 명시한다.

# Maven vs Gradle


            Gradle이 시기적으로 늦게 나온만큼 사용성, 성능 등 비교적 뛰어난 스펙을 가지고 있다.            
            Build라는 동적인 요소를 XML로 정의하기에는 어려운 부분이 많다.
            설정 내용이 길어지고 가독성 떨어짐
            의존관계가 복잡한 프로젝트 설정하기에는 부적절
            상속구조를 이용한 멀티 모듈 구현
            특정 설정을 소수의 모듈에서 공유하기 위해서는 부모 프로젝트를 생성하여 상속하게 해야함 (상속의 단점 생김)
            Gradle은 그루비를 사용하기 때문에, 동적인 빌드는 Groovy 스크립트로 플러그인을 호출하거나 직접 코드를 짜면 된다.
            Configuration Injection 방식을 사용해서 공통 모듈을 상속해서 사용하는 단점을 커버했다.
            설정 주입시 프로젝트의 조건을 체크할 수 있어서 프로젝트별로 주입되는 설정을 다르게 할 수 있다.
            Gradle은 메이븐보다 최대 100배 빠르다.