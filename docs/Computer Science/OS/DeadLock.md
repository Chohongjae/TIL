# 데드락이란

- 멀티 프로그래밍 환경에서 한정된 자원을 사용하려고 서로 경쟁하는 상황에서 어떤 프로세스가 자원을 요청할 때<br>
그 시간에 자원을 사용할 수 없는 상황이 발생하여 프로세스가 무한정 대기상태에 들어간 것을 말한다.
    1. 상호배제 - > 자원은 한번에 한 프로세스만 사용한다.
    2. 점유대기 - > 최소한 하나의 자원을 점유하고 있으면서, 다른 프로세스의 자원을 추가로 점유하기 위해 대기하는 프로세스 존재
    3. 비선점 - > 다른 프로세스의 자원은 사용이 끝날때까지 뺏을 수 없다.
    4. 순환대기 - > 순환적으로 다른 프로세스의 점유한 자원을 대기한다.
    
- 이 조건들이 모두 발생하면 데드락(교착상태)가 발생하고 하나라도 발생하지 않으면 교착상태가 일어나지 않는다.

## 공유자원
- 여러 스레드가 동시에 접근, 수정, 공유가능한 자원
- 선점형 스케쥴링에서는 어느 한 스레드의 연산이 끝날때까지 컨텍스트 스위칭을 기다려주지 않는다.<br>
컨텍스트 스위칭이 언제 일어나는지에 따라 전혀 다른 결과가 나오는데, 이처럼 스레드 여러개가 공유자원에 동시에<br>
접근하는 것을 경쟁조건(race condition)이라 한다.<br>
또한 공유자원에 접근해 변경을 시도하는 코드를 임계영역(critical section)이라고 한다.

## 상호배제(Mutual Exclusion)
- 경쟁조건 문제를 해결하기 위하여 사용하는 방법중에 하나로, 스레드 하나가 공유자원을 이용하는 동안에는 다른 스레드가<br>
접근하지 못하게 막는 것을 말하고 파이썬에서는 주로 Lock 객체를 활용한다.

            Lock 객체 생성 -> 한 스레드의 Lock 객체 획득 -> 다른 스레드는 대기
            -> Lock 객체를 획득했던 스레드가 임계영역을 빠져나와 Lock 객체 반환
            -> 다른 스레드의 Lock 객체 획득 및 임계영역 진입
            -> 다른 스레드 대기
            

## Python에서의 GIL
- GIL(global interpreter lock) 은 공유된 자원의 데이터를 여러 스레드가 접근하는 것을 막는 mutex이다.
    - 파이썬의 인터프리터인 cpython이 메모리를 관리하는 방법이 Thread safe하지 않기 떄문이다.
- 전역에 Lock 객체를 두고 이 Lock을 점유해야만 코드를 실행할 수 있도록 제어하는 상호배제를 구현하는 역할이다.<br>
때문에 동시에 1개 이상의 쓰레드가 공유자원에 접근할 수 없다. 즉 멀티코어에서도 싱글코어와 같은 효과가 난다.
    - 그럼에도 불구하고 CPU 작업이 적은 병렬처리 프로그램, I/O 작업이 더 많은 프로그램에서는 CPU 사용이 적으므로<br>
    GIL이 동작하지 않기 떄문에 여전히 멀티 쓰레드로 큰 성능향상을 이룰 수 있다.